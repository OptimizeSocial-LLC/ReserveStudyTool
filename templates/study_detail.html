{% extends "base.html" %}
{% block content %}
<section class="page-header">
  <h1>{{ study.property.name }} â€” Study completed on {{ study.created_at.strftime("%Y-%m-%d") }}</h1>
</section>

<div class="panel" style="margin-bottom:18px;">
  <div class="panel-header">
    <h2>Actions</h2>
    <p>Download the report, edit inputs, or clone this study to reuse inputs next time.</p>
  </div>

  <div class="form-actions" style="margin-top:12px;">
    <a class="btn-outline-sm" href="{{ url_for('download_study_csv', study_id=study.id) }}">Download CSV report</a>
    <a class="btn-outline-sm" href="{{ url_for('edit_study', study_id=study.id) }}">Edit inputs</a>
    <a class="btn-outline-sm" href="{{ url_for('clone_study', study_id=study.id) }}">Clone this study</a>
    <a class="btn-outline-sm" href="{{ url_for('property_page', property_id=study.property_id) }}">Back to property</a>
    <a class="btn-outline-sm" href="{{ url_for('home') }}">Home</a>
  </div>
</div>

<div class="forecast-layout">
  <div class="panel">
    <div class="panel-header">
      <h2>Components</h2>
      <p>Stored inputs.</p>
    </div>

    <div class="table-scroll">
      <table class="forecast-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Useful</th>
            <th>Remaining</th>
            <th class="value-cell">Cost</th>
          </tr>
        </thead>
        <tbody>
          {% for c in components %}
          <tr>
            <td>{{ c.name }}</td>
            <td>{{ c.useful_life_years }}</td>
            <td>{{ c.remaining_life_years }}</td>
            <td class="value-cell">${{ "{:,.0f}".format(c.current_replacement_cost) }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="panel">
    <div class="panel-header">
      <h2>Year-by-year results</h2>
      <p>Stored outputs (so you can regenerate reports any time).</p>
    </div>

    <div class="table-scroll">
      <table class="forecast-table">
        <thead>
          <tr>
            <th>Year</th>
            <th class="value-cell">Start</th>
            <th class="value-cell">Contrib</th>
            <th class="value-cell">Expenses</th>
            <th class="value-cell">Interest</th>
            <th class="value-cell">End</th>
          </tr>
        </thead>
        <tbody>
          {% for r in results %}
          <tr>
            <td>{{ r.year }}</td>
            <td class="value-cell">${{ "{:,.0f}".format(r.starting_balance) }}</td>
            <td class="value-cell">${{ "{:,.0f}".format(r.contributions) }}</td>
            <td class="value-cell">${{ "{:,.0f}".format(r.expenses) }}</td>
            <td class="value-cell">${{ "{:,.0f}".format(r.interest_earned) }}</td>
            <td class="value-cell">${{ "{:,.0f}".format(r.ending_balance) }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <p class="disclaimer-line">
      Placeholder model. Replace with your reserve-study methodology as needed.
    </p>
  </div>
</div>
{% endblock %}



